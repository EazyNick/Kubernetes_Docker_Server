<!-- 컨테이너 관리 페이지 - Docker 컨테이너의 상태를 모니터링하고 관리하는 페이지 -->
{% extends "base.html" %} {% block title %}컨테이너 - 컨테이너 모니터링{%
endblock %} {% block breadcrumb %}컨테이너{% endblock %} {% block content %}

<!-- 컨테이너 목록 테이블 섹션 -->
<div class="dashboard-card">
  <div class="dashboard-card-header">
    <h5 class="dashboard-card-title">
      <i class="fas fa-cubes"></i>
      컨테이너 목록
    </h5>
    <p class="dashboard-card-subtitle">
      실행 중인 모든 컨테이너의 상태 및 정보
    </p>
  </div>
  <div class="dashboard-card-body">
    <div class="table-container">
      <!-- 컨테이너 데이터 테이블 -->
      <table class="table table-hover" id="containersTable">
        <thead>
          <tr>
            <th class="sortable" data-column="name">
              이름 <i class="fas fa-sort sort-icon"></i>
            </th>
            <th class="sortable" data-column="image">
              이미지 <i class="fas fa-sort sort-icon"></i>
            </th>
            <th class="sortable" data-column="status">
              상태 <i class="fas fa-sort sort-icon"></i>
            </th>
            <th class="sortable" data-column="cpu">
              CPU <i class="fas fa-sort sort-icon"></i>
            </th>
            <th class="sortable" data-column="memory">
              메모리 <i class="fas fa-sort sort-icon"></i>
            </th>
            <th class="sortable" data-column="network">
              네트워크 <i class="fas fa-sort sort-icon"></i>
            </th>
            <th class="sortable" data-column="created">
              생성일 <i class="fas fa-sort sort-icon"></i>
            </th>
          </tr>
        </thead>
        <tbody>
          <!-- nginx 웹 서버 컨테이너 -->
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <i class="fas fa-cube text-primary me-2"></i>
                <strong>nginx-web-1</strong>
              </div>
            </td>
            <td>nginx:1.21</td>
            <td><span class="status-badge running">실행 중</span></td>
            <!-- CPU 사용률 표시 -->
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 23%; background: #059669"
                  ></div>
                </div>
                <span>23%</span>
              </div>
            </td>
            <!-- 메모리 사용률 표시 -->
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 45%; background: #d97706"
                  ></div>
                </div>
                <span>45%</span>
              </div>
            </td>
            <td>172.17.0.2</td>
            <td>2024-01-15 14:30</td>
            <td>
              <!-- 액션 버튼 제거됨 -->
            </td>
          </tr>
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <i class="fas fa-cube text-primary me-2"></i>
                <strong>nginx-web-2</strong>
              </div>
            </td>
            <td>nginx:1.21</td>
            <td><span class="status-badge running">실행 중</span></td>
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 31%; background: #059669"
                  ></div>
                </div>
                <span>31%</span>
              </div>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 52%; background: #d97706"
                  ></div>
                </div>
                <span>52%</span>
              </div>
            </td>
            <td>172.17.0.3</td>
            <td>2024-01-15 14:32</td>
            <td>
              <!-- 액션 버튼 제거됨 -->
            </td>
          </tr>
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <i class="fas fa-cube text-primary me-2"></i>
                <strong>redis-cache-1</strong>
              </div>
            </td>
            <td>redis:6.2</td>
            <td><span class="status-badge stopped">중지됨</span></td>
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 0%; background: #dc2626"
                  ></div>
                </div>
                <span>0%</span>
              </div>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 0%; background: #dc2626"
                  ></div>
                </div>
                <span>0%</span>
              </div>
            </td>
            <td>-</td>
            <td>2024-01-15 13:45</td>
            <td>
              <!-- 액션 버튼 제거됨 -->
            </td>
          </tr>
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <i class="fas fa-cube text-primary me-2"></i>
                <strong>postgres-db-1</strong>
              </div>
            </td>
            <td>postgres:13</td>
            <td><span class="status-badge running">실행 중</span></td>
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 67%; background: #d97706"
                  ></div>
                </div>
                <span>67%</span>
              </div>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 78%; background: #dc2626"
                  ></div>
                </div>
                <span>78%</span>
              </div>
            </td>
            <td>172.17.0.4</td>
            <td>2024-01-15 12:15</td>
            <td>
              <!-- 액션 버튼 제거됨 -->
            </td>
          </tr>
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <i class="fas fa-cube text-primary me-2"></i>
                <strong>api-gateway-1</strong>
              </div>
            </td>
            <td>nginx:1.21</td>
            <td><span class="status-badge running">실행 중</span></td>
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 15%; background: #059669"
                  ></div>
                </div>
                <span>15%</span>
              </div>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <div class="progress-modern me-2" style="width: 60px">
                  <div
                    class="progress-bar-modern"
                    style="width: 28%; background: #059669"
                  ></div>
                </div>
                <span>28%</span>
              </div>
            </td>
            <td>172.17.0.5</td>
            <td>2024-01-15 11:20</td>
            <td>
              <!-- 액션 버튼 제거됨 -->
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- 정렬 기능 JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const table = document.getElementById('containersTable');
  const headers = table.querySelectorAll('th.sortable');
  let currentSort = { column: null, direction: 'asc' };

  headers.forEach(header => {
    header.addEventListener('click', function() {
      const column = this.dataset.column;
      const tbody = table.querySelector('tbody');
      const rows = Array.from(tbody.querySelectorAll('tr'));

      // 정렬 방향 결정
      if (currentSort.column === column) {
        currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
      } else {
        currentSort.direction = 'asc';
      }
      currentSort.column = column;

      // 정렬 실행
      rows.sort((a, b) => {
        const aValue = getCellValue(a, column);
        const bValue = getCellValue(b, column);
        
        if (column === 'cpu' || column === 'memory') {
          // 숫자 정렬 (퍼센트 값) - 퍼센트 기호 제거 후 숫자로 변환
          const aNum = parseFloat(aValue.replace('%', '')) || 0;
          const bNum = parseFloat(bValue.replace('%', '')) || 0;
          return currentSort.direction === 'asc' ? aNum - bNum : bNum - aNum;
        } else if (column === 'created') {
          // 날짜 정렬
          const aDate = new Date(aValue);
          const bDate = new Date(bValue);
          return currentSort.direction === 'asc' ? aDate - bDate : bDate - aDate;
        } else {
          // 문자열 정렬
          return currentSort.direction === 'asc' 
            ? aValue.localeCompare(bValue)
            : bValue.localeCompare(aValue);
        }
      });

      // 테이블 업데이트
      rows.forEach(row => tbody.appendChild(row));

      // 정렬 아이콘 업데이트
      updateSortIcons();
    });
  });

  function getCellValue(row, column) {
    const cellIndex = Array.from(headers).findIndex(h => h.dataset.column === column);
    const cell = row.cells[cellIndex];
    
    if (column === 'name') {
      return cell.querySelector('strong').textContent;
    } else if (column === 'status') {
      return cell.querySelector('.status-badge').textContent;
    } else if (column === 'cpu' || column === 'memory') {
      return cell.querySelector('span').textContent;
    } else {
      return cell.textContent.trim();
    }
  }

  function updateSortIcons() {
    headers.forEach(header => {
      const icon = header.querySelector('.sort-icon');
      icon.className = 'fas fa-sort sort-icon';
      
      if (header.dataset.column === currentSort.column) {
        icon.className = currentSort.direction === 'asc' 
          ? 'fas fa-sort-up sort-icon' 
          : 'fas fa-sort-down sort-icon';
      }
    });
  }
});
</script>

{% endblock %}
