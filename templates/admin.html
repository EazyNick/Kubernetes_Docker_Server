<!-- 관리자 페이지 - 사용자 관리 시스템 -->
{% extends "base.html" %}
{% block title %}관리자 - 사용자 관리{% endblock %}
{% block breadcrumb %}관리자{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/admin.css">
{% endblock %}

{% block content %}
<div class="admin-container">
  <!-- 관리자 통계 카드 -->
  <div class="admin-stats-grid">
    <div class="stat-card">
      <div class="stat-icon primary">
        <i class="fas fa-users"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="totalUsers">-</div>
        <div class="stat-label">전체 사용자</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon success">
        <i class="fas fa-user-check"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="activeUsers">-</div>
        <div class="stat-label">활성 사용자</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon warning">
        <i class="fas fa-user-shield"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="adminUsers">-</div>
        <div class="stat-label">관리자</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon info">
        <i class="fas fa-clock"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="recentLogins">-</div>
        <div class="stat-label">최근 로그인</div>
      </div>
    </div>
  </div>

  <!-- 사용자 관리 섹션 -->
  <div class="admin-section">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-users-cog"></i>
        사용자 관리
      </h2>
      <div class="header-actions">
        <div class="search-box">
          <input type="text" class="form-control" id="userSearch" placeholder="사용자명 또는 이메일로 검색...">
          <i class="fas fa-search"></i>
        </div>
        <button class="btn btn-primary" id="addUserBtn">
          <i class="fas fa-plus"></i>
          사용자 추가
        </button>
      </div>
    </div>

    <!-- 사용자 목록 테이블 -->
    <div class="table-container">
      <table class="table" id="usersTable">
        <thead>
          <tr>
            <th>사용자명</th>
            <th>이메일</th>
            <th>권한</th>
            <th>상태</th>
            <th>생성일</th>
            <th>마지막 로그인</th>
            <th>작업</th>
          </tr>
        </thead>
        <tbody id="usersTableBody">
          <!-- 사용자 데이터가 여기에 동적으로 로드됩니다 -->
        </tbody>
      </table>
    </div>

    <!-- 페이지네이션 -->
    <div class="pagination-container">
      <nav aria-label="사용자 목록 페이지네이션">
        <ul class="pagination" id="pagination">
          <!-- 페이지네이션 버튼들이 여기에 동적으로 생성됩니다 -->
        </ul>
      </nav>
    </div>
  </div>
</div>

<!-- 사용자 추가/수정 모달 -->
<div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="userModalLabel">사용자 추가</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="userForm">
          <input type="hidden" id="userId" name="userId">
          
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="username" class="form-label">사용자명 *</label>
                <input type="text" class="form-control" id="username" name="username" required>
                <div class="invalid-feedback" id="usernameError"></div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="password" class="form-label">비밀번호 *</label>
                <input type="password" class="form-control" id="password" name="password" required>
                <div class="invalid-feedback" id="passwordError"></div>
              </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="email" class="form-label">이메일 *</label>
                <input type="email" class="form-control" id="email" name="email" required>
                <div class="invalid-feedback" id="emailError"></div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="role" class="form-label">권한</label>
                <select class="form-select" id="role" name="role">
                  <option value="user">사용자</option>
                  <option value="admin">관리자</option>
                  <option value="guest">게스트</option>
                </select>
              </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="isActive" name="isActive" checked>
                  <label class="form-check-label" for="isActive">
                    활성 상태
                  </label>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
        <button type="button" class="btn btn-primary" id="saveUserBtn">저장</button>
      </div>
    </div>
  </div>
</div>

<!-- 사용자 삭제 확인 모달 -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">사용자 삭제 확인</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>정말로 이 사용자를 삭제하시겠습니까?</p>
        <p class="text-muted">이 작업은 되돌릴 수 없습니다.</p>
        <input type="hidden" id="deleteUserId">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
        <button type="button" class="btn btn-danger" id="confirmDeleteBtn">삭제</button>
      </div>
    </div>
  </div>
</div>

<!-- 알림 메시지 -->
<div class="toast-container position-fixed top-0 end-0 p-3">
  <div id="adminToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="toast-header">
      <i class="fas fa-info-circle text-primary me-2"></i>
      <strong class="me-auto">알림</strong>
      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
    <div class="toast-body" id="toastMessage">
      <!-- 메시지 내용 -->
    </div>
  </div>
</div>

{% endblock %}
