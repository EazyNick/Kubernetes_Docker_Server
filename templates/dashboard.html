{% extends "base.html" %}
{% block title %}대시보드 - 컨테이너 모니터링{% endblock %}
{% block breadcrumb %}대시보드{% endblock %}
{% block content %}

<div class="row mb-4">
  <div class="col-12">
    <div class="dashboard-card">
      <div class="dashboard-card-header">
        <div class="dashboard-card-title">
          <i class="fas fa-heartbeat"></i>
          클러스터 상태
        </div>
        <div class="dashboard-card-subtitle">실시간 인프라 건강성 모니터링</div>
      </div>
    </div>
  </div>
</div>

<div class="metric-grid">
  <div class="metric-card">
    <div class="metric-card-header">
      <div class="metric-icon primary">
        <i class="fas fa-cubes"></i>
      </div>
    </div>
    <div class="metric-value" id="totalContainers">147</div>
    <div class="metric-label">전체 컨테이너</div>
    <div class="metric-change positive">
      <i class="fas fa-arrow-up"></i>
      <span>+3.2%</span>
    </div>
  </div>

  <div class="metric-card">
    <div class="metric-card-header">
      <div class="metric-icon success">
        <i class="fas fa-play-circle"></i>
      </div>
    </div>
    <div class="metric-value" id="runningContainers">134</div>
    <div class="metric-label">실행 중</div>
    <div class="metric-change positive">
      <i class="fas fa-arrow-up"></i>
      <span>+1.8%</span>
    </div>
  </div>

  <div class="metric-card">
    <div class="metric-card-header">
      <div class="metric-icon warning">
        <i class="fas fa-pause-circle"></i>
      </div>
    </div>
    <div class="metric-value" id="stoppedContainers">8</div>
    <div class="metric-label">중지됨</div>
    <div class="metric-change negative">
      <i class="fas fa-arrow-down"></i>
      <span>-0.5%</span>
    </div>
  </div>

  <div class="metric-card">
    <div class="metric-card-header">
      <div class="metric-icon danger">
        <i class="fas fa-exclamation-circle"></i>
      </div>
    </div>
    <div class="metric-value" id="failedContainers">5</div>
    <div class="metric-label">실패</div>
    <div class="metric-change negative">
      <i class="fas fa-arrow-up"></i>
      <span>+2</span>
    </div>
  </div>
</div>

<div class="row mb-4">
  <div class="col-lg-3 col-md-6 mb-4">
    <div class="metric-card">
      <div class="metric-card-header">
        <div class="metric-icon primary">
          <i class="fas fa-server"></i>
        </div>
      </div>
      <div class="metric-value" id="activeNodes">12</div>
      <div class="metric-label">활성 노드</div>
      <div class="metric-change positive">
        <i class="fas fa-arrow-up"></i>
        <span>+1</span>
      </div>
    </div>
  </div>

  <div class="col-lg-3 col-md-6 mb-4">
    <div class="metric-card">
      <div class="metric-card-header">
        <div class="metric-icon warning">
          <i class="fas fa-microchip"></i>
        </div>
      </div>
      <div class="metric-value" id="avgCpuUsage">68%</div>
      <div class="metric-label">평균 CPU 사용률</div>
      <div class="metric-change positive">
        <i class="fas fa-arrow-up"></i>
        <span>+5%</span>
      </div>
    </div>
  </div>

  <div class="col-lg-3 col-md-6 mb-4">
    <div class="metric-card">
      <div class="metric-card-header">
        <div class="metric-icon info">
          <i class="fas fa-memory"></i>
        </div>
      </div>
      <div class="metric-value" id="avgMemoryUsage">72%</div>
      <div class="metric-label">평균 메모리 사용률</div>
      <div class="metric-change positive">
        <i class="fas fa-arrow-up"></i>
        <span>+3%</span>
      </div>
    </div>
  </div>

  <div class="col-lg-3 col-md-6 mb-4">
    <div class="metric-card">
      <div class="metric-card-header">
        <div class="metric-icon success">
          <i class="fas fa-network-wired"></i>
        </div>
      </div>
      <div class="metric-value" id="networkTraffic">1.2GB</div>
      <div class="metric-label">네트워크 트래픽</div>
      <div class="metric-change positive">
        <i class="fas fa-arrow-up"></i>
        <span>+15%</span>
      </div>
    </div>
  </div>
</div>

<div class="row mb-4">
  <div class="col-lg-6 mb-4">
    <div class="dashboard-card">
      <div class="dashboard-card-header">
        <h5 class="dashboard-card-title">
          <i class="fas fa-microchip"></i>
          CPU 사용률
        </h5>
        <p class="dashboard-card-subtitle">최근 24시간 CPU 사용률 추이</p>
      </div>
      <div class="dashboard-card-body">
        <div class="chart-container">
          <canvas id="cpuChart"></canvas>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-6 mb-4">
    <div class="dashboard-card">
      <div class="dashboard-card-header">
        <h5 class="dashboard-card-title">
          <i class="fas fa-memory"></i>
          메모리 사용률
        </h5>
        <p class="dashboard-card-subtitle">최근 24시간 메모리 사용률 추이</p>
      </div>
      <div class="dashboard-card-body">
        <div class="chart-container">
          <canvas id="memoryChart"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row mb-4">
  <div class="col-lg-6 mb-4">
    <div class="dashboard-card">
      <div class="dashboard-card-header">
        <h5 class="dashboard-card-title">
          <i class="fas fa-network-wired"></i>
          네트워크 트래픽
        </h5>
        <p class="dashboard-card-subtitle">인바운드/아웃바운드 트래픽</p>
      </div>
      <div class="dashboard-card-body">
        <div class="chart-container">
          <canvas id="networkChart"></canvas>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-6 mb-4">
    <div class="dashboard-card">
      <div class="dashboard-card-header">
        <h5 class="dashboard-card-title">
          <i class="fas fa-hdd"></i>
          디스크 I/O
        </h5>
        <p class="dashboard-card-subtitle">디스크 읽기/쓰기 성능</p>
      </div>
      <div class="dashboard-card-body">
        <div class="chart-container">
          <canvas id="diskChart"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row mb-4">
  <div class="col-12">
    <div class="dashboard-card">
      <div class="dashboard-card-header">
        <h5 class="dashboard-card-title">
          <i class="fas fa-bell"></i>
          최근 알림
        </h5>
        <p class="dashboard-card-subtitle">시스템에서 발생한 최근 알림</p>
      </div>
      <div class="dashboard-card-body">
        <div class="alert-list">
          <div class="alert-item success">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <strong>컨테이너 시작</strong>
                <p class="mb-1 text-muted small">
                  nginx-web-2 컨테이너가 성공적으로 시작되었습니다.
                </p>
                <small class="text-muted">5분 전</small>
              </div>
              <span class="status-badge running">정상</span>
            </div>
          </div>

          <div class="alert-item warning">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <strong>높은 CPU 사용률</strong>
                <p class="mb-1 text-muted small">
                  worker-node-3의 CPU 사용률이 85%를 초과했습니다.
                </p>
                <small class="text-muted">12분 전</small>
              </div>
              <span class="status-badge warning">경고</span>
            </div>
          </div>

          <div class="alert-item danger">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <strong>컨테이너 실패</strong>
                <p class="mb-1 text-muted small">
                  redis-cache-1 컨테이너가 예기치 않게 종료되었습니다.
                </p>
                <small class="text-muted">15분 전</small>
              </div>
              <span class="status-badge stopped">위험</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

<!-- API 모듈들 -->
<script src="/static/js/api/stats.js"></script>
<script src="/static/js/api/containers.js"></script>
<script src="/static/js/api/nodes.js"></script>
<script src="/static/js/api/alerts.js"></script>
<script src="/static/js/api/events.js"></script>
